<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Exoplanet Habitability Explorer</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Axios -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<!-- Main CSS -->
<link rel="stylesheet" href="/static/css/style.css">

<style>
body{
    color:#ffffff;
    font-family: 'Segoe UI', sans-serif;
}

/* Dark overlay over background image */
.overlay{
    background:rgba(0,0,0,0.78);
    min-height:100vh;
    padding-top:120px; /* space for navbar */
}

/* Cards */
.card{
    background:linear-gradient(145deg,#0f2027,#203a43,#2c5364);
    border-radius:25px;
    box-shadow:0 0 35px rgba(0,255,255,0.45);
}

/* Slider labels */
.slider-label{
    color:#9dfcff;
    font-weight:600;
    text-shadow:0 0 8px rgba(0,255,255,0.8);
}

/* Slider value badge */
.value-badge{
    background:#00e5ff;
    color:#000;
    padding:6px 14px;
    border-radius:20px;
    font-weight:bold;
    margin-left:10px;
}

/* Predict button */
.btn-predict{
    background:linear-gradient(45deg,#00e5ff,#00bcd4);
    color:#000;
    font-weight:bold;
    border:none;
    border-radius:30px;
    padding:12px 35px;
    box-shadow:0 0 25px rgba(0,255,255,0.7);
}

/* Result box */
.result-box{
    border:2px solid #00e5ff;
    border-radius:18px;
    padding:20px;
    margin-top:25px;
}
</style>
</head>

<body>

<!-- üîπ NAVBAR -->
{% include "navbar.html" %}

<!-- üîπ OVERLAY START -->
<div class="overlay">

<div class="container">

    <!-- Title -->
    <div class="text-center mb-4">
        <h1>üåå Exoplanet Habitability Explorer</h1>
        <p class="text-info">AI-Powered Planetary Evaluation System</p>
    </div>

    <!-- Main Card -->
    <div class="row justify-content-center">
    <div class="col-lg-8">

        <div class="card p-4">

            <!-- Planet Name -->
            <div class="mb-4 text-center">
                <label class="slider-label">ü™ê Planet Name</label><br>
                <input type="text"
                       id="planet_name"
                       class="form-control text-center mt-2"
                       placeholder="Enter Exoplanet Name"
                       style="background:#000;color:#00e5ff;border:2px solid #00e5ff;border-radius:25px;">
            </div>

            <!-- Sliders -->
            <div class="row g-4">
                <script>
                const sliders = [
                    ["pl_orbper","Orbital Period (days)",1,1000,365],
                    ["pl_orbeccen","Orbital Eccentricity",0,1,0.016],
                    ["pl_rade","Planet Radius (Earth)",0.5,3,1.2],
                    ["pl_bmasse","Planet Mass (Earth)",0.1,5,1.1],
                    ["pl_eqt","Equilibrium Temperature (K)",200,400,288],
                    ["pl_insol","Insolation Flux",0.1,3,1.0],
                    ["st_teff","Star Temperature (K)",3000,7000,5700],
                    ["st_rad","Star Radius (Solar)",0.5,2,1.0],
                    ["st_mass","Star Mass (Solar)",0.5,2,1.0],
                    ["st_lum","Star Luminosity",0.1,3,1.0],
                    ["sy_dist","Distance from Earth (pc)",1,100,10]
                ];

                sliders.forEach(s=>{
                    document.write(`
                    <div class="col-md-6">
                        <label class="slider-label">${s[1]}</label><br>
                        <input type="range" class="form-range"
                               min="${s[2]}" max="${s[3]}" step="0.01"
                               id="${s[0]}" value="${s[4]}"
                               oninput="document.getElementById('${s[0]}_val').innerText=this.value">
                        <span class="value-badge" id="${s[0]}_val">${s[4]}</span>
                    </div>
                    `);
                });
                </script>
            </div>

            <!-- Predict Button -->
            <div class="text-center mt-4">
                <button class="btn btn-predict" onclick="predictPlanet()">
                    üîç Predict Habitability
                </button>
            </div>

            <!-- Result -->
            <div class="result-box text-center">
                <h4>üåç Prediction Result</h4>
                <h1 id="score" class="text-info">--</h1>
                <h3 id="status" class="text-warning">Awaiting Prediction</h3>
            </div>

        </div>
    </div>
    </div>

</div>
</div>
<!-- üîπ OVERLAY END -->

<!-- JS -->
<script>
const API_KEY="SECRET123";

function getData(){
    let data = {};
    data["planet_name"] =
        document.getElementById("planet_name").value || "Unknown";

    sliders.forEach(s=>{
        data[s[0]] = parseFloat(document.getElementById(s[0]).value);
    });

    // Required categorical defaults
    data["st_spectype"] = "G2V";
    data["discoverymethod"] = "Transit";
    return data;
}

function predictPlanet(){
    let data = getData();

    axios.post("/predict", data, {
        headers:{
            "x-api-key":API_KEY,
            "Content-Type":"application/json"
        }
    }).then(res=>{
        document.getElementById("score").innerText =
            res.data.habitability_score.toFixed(3);

        document.getElementById("status").innerText =
            res.data.habitability_prediction===1
            ? "üåç Habitable"
            : "‚ùå Not Habitable";

        axios.post("/store", data, {
            headers:{
                "x-api-key":API_KEY,
                "Content-Type":"application/json"
            }
        });
    });
}
</script>

</body>
</html>
